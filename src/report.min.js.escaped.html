<html><table><pre>(async()=>{if(document.location.origin+document.location.pathname!="https://app.spendit.kr/reports")return void alert("https://app.spendit.kr/reports 페이지에서 실행해주세요.");let t,e;(e=document.querySelector("ul#user>li#policy")).innerText!=v.policy&&(t=[...(t=await d(e.querySelector("div"),"ul",e)).querySelectorAll("li>a")].filter(t=>t.innerText==v.policy)[0],await d(t,document.querySelector("div#alarm-pop"))),t=await d(document.querySelector("div#application div.button-group>button"),"div.swal2-container button.swal2-confirm"),await d(t,"div#report-document"),await d(null,"div#alarm-pop.disabled"),await c(300),e=document.querySelector("div#report-document header"),await u(null,v.title,"h3","input",e),v.tax.startsWith("세금계산서")&&(e=s("보고서 타입"),await d(e.querySelector("button"),"button",e),t=[...e.querySelectorAll("div>div+button+div>div")].filter(t=>"세금계산서"==t.innerText)[0],t=await d(t,"div.swal2-popup button.swal2-confirm"),await d(t,"div#report-document"),await d(null,"div#alarm-pop.disabled"),await c(300)),await u("지급처(이름)",v.sangho),await u("주민등록번호",v.regNo),await u("실지급금액",v.price),t=(e=s("지급희망일")).querySelector("div>input");let n=(t=await d(t,"table",e)).querySelector("div.rdtDays th.rdtSwitch"),i=parseInt(n.innerText.split(" ").pop()),o=parseInt(n.getAttribute("data-value")),r=i-v.year;if(r>1||r&lt;0)return void alert("1년 전만 지원합니다!");let a=0;1==r&&(a=12);let l=o+a-v.month;for(let e=0;e&lt;l;e++)await d(t.querySelector("th.rdtPrev"),t);function c(t){return new Promise(e=>setTimeout(e,t))}async function u(t,e,n="div",i="input",o=null){if(o||(o=s(t)),!o||!e)return;let r=o.querySelector(n);(function(t,e,n="input"){let i=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;"textarea"==n&&(i=Object.getOwnPropertyDescriptor(window.HTMLTextAreaElement.prototype,"value").set);const o=new Event("input",{bubbles:!0});i.call(t,e),t.dispatchEvent(o)})(r=await d(r,i,o),e,i),function(t){const e=Object.keys(t).filter(t=>t.startsWith("__reactEventHandlers$"))[0];t[e].onMouseDown?t[e].onMouseDown():t[e].onClick?t[e].onClick():t[e].onBlur?t[e].onBlur():console.warn("no event handler found on",t)}(r),await d(null,"div#alarm-pop"),await c(500)}function d(t,e=null,n=document.documentElement){return new Promise((i,o)=>{let r,a;e?"string"==typeof e&&(r=e,e=n):e=t,(a=r?new MutationObserver(t=>{let e=[...n.querySelectorAll(r)];e.length>0&&(a.disconnect(),console.log(e[e.length-1],"resolved"),i(e[e.length-1]))}):new MutationObserver(t=>{a.disconnect(),console.log(e,"resolved (selector not presented)"),i(e)})).observe(e,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),t&&t.click(),console.log(t,"clicked")})}function s(t){let e=[...document.querySelectorAll("div#report-document>div:last-child div")];return e=(e=e.filter(e=>e.textContent==t).pop())?e.nextSibling:null}[...e.querySelectorAll('td[class="rdtDay"], td.rdtActive')][v.day-1].click(),await u("은행명",v.bank),await u("예금주",v.accountOwner),await u("계좌번호",v.accountNo),await u("전자결재문서",v.docNo),await u("계약서",v.agreementNo),await u("내용",v.content,"div","textarea"),await d(s("지출 추가"),'div.spendit-modal-container>div input[type="checkbox"]'),t=[...(e=document.querySelector("div.spendit-modal-container>div")).querySelectorAll("div")].filter(t=>t.innerText.trim().split(" ")==v.sangho)[0].parentNode.firstChild.querySelector("input"),t=await d(t,"footer button",e),t=await d(t,'div[class*="actions"] button[class*="confirm"]'),t=await d(t,"div#report-view>div>ul>li>button"),alert("완료. 세금계산서는 지출 카테고리와 예산항목을 수정해야 하고, 정기지출은 수동으로 pdf 파일을 첨부해야 함)"),document.querySelector("div.add-file-field").scrollIntoView()})();</pre></table></html>